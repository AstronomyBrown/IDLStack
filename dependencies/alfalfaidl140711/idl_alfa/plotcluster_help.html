<!-- This file was generated by mk_html_help.pro -->
<html>
 
<head>
<TITLE>Extended IDL Help</TITLE>
</head>
 
<body>
<H1>Extended IDL Help</H1>
<P>
This page was created by the IDL library routine 
<CODE>mk_html_help</CODE>.  For more information on 
this routine, refer to the IDL Online Help Navigator 
or type: <P>
<PRE>     ? mk_html_help</PRE><P>
at the IDL command line prompt.<P>
<STRONG>Last modified: </STRONG>Wed Jul 19 10:58:41 2006.<P>
 
<HR>
 
<A NAME="ROUTINELIST">
<H1>List of Routines</H1></A>
<UL>
<LI><A HREF="#CARTES">CARTES</A>
<LI><A HREF="#CARTTOLBR">CARTTOLBR</A>
<LI><A HREF="#DELCHR">DELCHR</A>
<LI><A HREF="#DRAWCLUST">DRAWCLUST</A>
<LI><A HREF="#DRAWGAL">DRAWGAL</A>
<LI><A HREF="#DRAWNOG">DRAWNOG</A>
<LI><A HREF="#GETBOUNDS">GETBOUNDS</A>
<LI><A HREF="#ISNUMBER">ISNUMBER</A>
<LI><A HREF="#KLMFLOW">KLMFLOW</A>
<LI><A HREF="#MYDELTAV">MYDELTAV</A>
<LI><A HREF="#MYFLOWMODEL">MYFLOWMODEL</A>
<LI><A HREF="#MYFLOWMODELCALL">MYFLOWMODELCALL</A>
<LI><A HREF="#NWRDS">NWRDS</A>
<LI><A HREF="#PLOTCLUSTER">PLOTCLUSTER</A>
<LI><A HREF="#PLOTFRAME">PLOTFRAME</A>
<LI><A HREF="#PLOTHISTANDCZR_CLUSTER">PLOTHISTANDCZR_CLUSTER</A>
<LI><A HREF="#PLOTHISTANDCZR_NOG">PLOTHISTANDCZR_NOG</A>
<LI><A HREF="#PRINTAGCINFO">PRINTAGCINFO</A>
<LI><A HREF="#PRINTCLUSTERINFO">PRINTCLUSTERINFO</A>
<LI><A HREF="#PRINTNOGINFO">PRINTNOGINFO</A>
<LI><A HREF="#SAVESTATEINFO">SAVESTATEINFO</A>
<LI><A HREF="#VHEL_TO_CMB">VHEL_TO_CMB</A>
<LI><A HREF="#ZBRAKVEL">ZBRAKVEL</A>
<LI><A HREF="#ZBRENTVEL">ZBRENTVEL</A>
</UL><P>
 
<HR>
 
<H1>Routine Descriptions</H1>
<A NAME="CARTES">
<H2>CARTES</H2></A>
<A HREF="#CARTTOLBR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: 
	CARTES

PURPOSE:
	Calculates the separation between two objects. Input and output in degrees!

SYNTAX: 
	result=CARTES(r1,r2,d1,d2)

INPUTS: 
	r1 - RA of object one in degrees
	r2 - RA of object two in degrees
	d1 - Dec of object one in degrees
	d2 - Dec of object two in degrees
OUTPUTS: 
	result - separation of objects in rad

</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="CARTTOLBR">
<H2>CARTTOLBR</H2></A>
<A HREF="#CARTES">[Previous Routine]</A>
<A HREF="#DELCHR">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	CARTTOLBR

 PURPOSE: 
	Converts Cartesian coordinates to l,b,r in radians.

 EXPLANATION:
	Input is x,y,z, output is r in same units and l and b in radians.
	SUPERGALACTIC x,y,z, l=SGL, b=SGB. 

 SYNTAX:
       CARTTOLBR, x, y, z, l, b, r 

 INPUTS:
       x, y, z - Cartesian coordinates
	

 OUTPUTS:
	l, b, r - Galactic coordinates; l,b, in radians, r in units of x,y,z

 MODIFICATION HISTORY:
	Written	KLM	May 2003
       Converted to IDL   A. Martin   June 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="DELCHR">
<H2>DELCHR</H2></A>
<A HREF="#CARTTOLBR">[Previous Routine]</A>
<A HREF="#DRAWCLUST">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       DELCHR
 PURPOSE:
       Delete all occurrences of a character from a text string.
 CATEGORY:
 SYNTAX:
       new = delchr(old, char)
 INPUTS:
       old = original text string.     in
       char = character to delete.     in
 KEYWORD PARAMETERS:
 OUTPUTS:
       new = resulting string.         out
 COMMON BLOCKS:
 NOTES:
 MODIFICATION HISTORY:
       R. Sterner.  5 Jul, 1988.
       Johns Hopkins Applied Physics Lab.
       RES 11 Sep, 1989 --- converted to SUN.
       R. Sterner, 27 Jan, 1993 --- dropped reference to array.

 Copyright (C) 1988, Johns Hopkins University/Applied Physics Laboratory
 This software may be used, copied, or redistributed as long as it is not
 sold and this copyright notice is reproduced on each copy made.  This
 routine is provided as is without any express or implied warranties
 whatsoever.  Other limitations apply as described in the file disclaimer.txt.
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="DRAWCLUST">
<H2>DRAWCLUST</H2></A>
<A HREF="#DELCHR">[Previous Routine]</A>
<A HREF="#DRAWGAL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       DRAWCLUST
 PURPOSE:
       Returns an array with the cluster coordinates that draw the
       cluster

 EXPLANATION:
       Takes the cluster radius and creates arrays that hold the
       cluster drawing coordinates

 SYNTAX:
       DRAWGAL, XIN, YIN, CLUST_RAD,XCLUST, YCLUST, NCLUSTPTS

 INPUTS:
       XIN - The x coordinate of the cluster center  
       YIN - The y coordinate of the cluster center
       CLUST_RAD - The radius of the cluster

 OUTPUTS:
       XCLUST - The array with the x positions of the clusters (this is to
           plot the cluster)
       YCLUST - The array with the y positions of the cluster (this is to
           plot the cluster circle)
       NCLUSTPTS - Number of points used to draw the cluster (length of
                 the xclust and yclust arrays)

 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="DRAWGAL">
<H2>DRAWGAL</H2></A>
<A HREF="#DRAWCLUST">[Previous Routine]</A>
<A HREF="#DRAWNOG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       DRAWGAL
 PURPOSE:
       Returns an array with the galaxy coordinates that draw the
       galaxy

 EXPLANATION:
       Takes the galaxy radius and creates arrays that hold the
       galaxy drawing coordinates

 SYNTAX:
       DRAWGAL, XIN, YIN, GRAD, GEPS, GPA, SCALE, XGAL, YGAL, NGALPTS

 INPUTS:
       XIN - The x coordinate of the galaxy center  
       YIN - The y coordinate of the galaxy center
       GRAD - The radius of the galaxy
       GEPS - The galaxy eccentricity
       SCALE - Scaling factor to use when making output arrays

 OUTPUTS:
       XGAL - The array with the x positions of the galaxies (this is to
           plot the galaxy)
       YGAL - The array with the y positions of the galaxy (this is to
           plot the galaxy)
       NGALPTS - Number of points used to draw the galaxy (length of
                 the xgal and ygal arrays)

 REVISION HISTORY:
       Written by M.H. in fortran and translated to idl by
       W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="DRAWNOG">
<H2>DRAWNOG</H2></A>
<A HREF="#DRAWGAL">[Previous Routine]</A>
<A HREF="#GETBOUNDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       DRAWNOG
 PURPOSE:
       Returns an array with the nog group coordinates that draw the
       group

 EXPLANATION:
       Takes the nog velocity and creates arrays that hold the
       group drawing coordinates

 SYNTAX:
       DRAWNOG, XIN, YIN, VEL, XNOG, YNOG, NNOGPTS

 INPUTS:
       XIN - The x coordinate of the group center  
       YIN - The y coordinate of the group center
       VEL - The velocity of the group

 OUTPUTS:
       XNOG - The array with the x positions of the group (this is to
           plot the group circle)
       YNOG - The array with the y positions of the group (this is to
           plot the group circle)
       NNOGPTS - Number of points used to draw the group (length of
                 the xnog and ynog arrays)

 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="GETBOUNDS">
<H2>GETBOUNDS</H2></A>
<A HREF="#DRAWNOG">[Previous Routine]</A>
<A HREF="#ISNUMBER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       GETBOUNDS
 PURPOSE:
       Calculates the plot bounds with the user defined range

 EXPLANATION:
       Take the center R.A., center Dec and range given by the user
       and calculate the minimum and maximum R.A. and Dec

 SYNTAX:
       GETBOUNDS, CENTRA, CENTDEC, RAMIN, RAMAX, DECMIN, DECMAX, NPIX

 INPUTS:
       CENTRA - Center R.A. defined by user
       CENTRDEC - Center Dec defined by user
       NPIX - Range defined by user 

 OUTPUTS:
       RAMIN - Minimum R.A. in range
       RAMAX - Maximum R.A. in range
       DECMIN - Minimum Dec in range
       DECMAX - Maximum Dec in range  

 REVISION HISTORY:
       Written by M.H. in fortran and translated and updated to idl
       by W.H.during summer 2006
  
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="ISNUMBER">
<H2>ISNUMBER</H2></A>
<A HREF="#GETBOUNDS">[Previous Routine]</A>
<A HREF="#KLMFLOW">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       ISNUMBER
 PURPOSE:
       Determine if a text string is a valid number.
 CATEGORY:
 SYNTAX:
       i = isnumber(txt, [x])
 INPUTS:
       txt = text string to test.                      in
 KEYWORD PARAMETERS:
 OUTPUTS:
       x = optionaly returned numeric value if valid.  out
       i = test flag:                                  out
           0: not a number.
           1: txt is a long integer.
           2: txt is a float.
           -1: first word of txt is a long integer.
           -2: first word of txt is a float.
 COMMON BLOCKS:
 NOTES:
 MODIFICATION HISTORY:
       R. Sterner.  15 Oct, 1986.
       Johns Hopkins Applied Physics Lab.
       R. Sterner, 12 Mar, 1990 --- upgraded.
	Richard Garrett, 14 June, 1992 --- fixed bug in returned float value.

 Copyright (C) 1986, Johns Hopkins University/Applied Physics Laboratory
 This software may be used, copied, or redistributed as long as it is not
 sold and this copyright notice is reproduced on each copy made.  This
 routine is provided as is without any express or implied warranties
 whatsoever.  Other limitations apply as described in the file disclaimer.txt.
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="KLMFLOW">
<H2>KLMFLOW</H2></A>
<A HREF="#ISNUMBER">[Previous Routine]</A>
<A HREF="#MYDELTAV">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
	KLMFLOW
PURPOSE:
 	Based on a Fortran subroutine written by John Tonry (available on-line).
	Edited to deal with distances in km/s (independent of Hubble's constant).
	This version also uses NFW profiles for the attractors, and does not include
	cutoff radii, except for the quadrupole.

SYNTAX:
	KLMFLOW, x, y, z, vx, vy, vz, vr, sig

INPUTS:
	x, y, z - Cartesian SuperGalactic coordinates of the source galaxy

OUTPUTS:
	vx, vy, vz - velocity in SG cartesian coords in CMB frame
	vr - radial velocity in CMB frame
	vsig - velocity dispersion at location of galaxy
	
REVISION HISTORY:
	Created  Karen L. Masters (KLM)
       Converted to IDL   A.Martin   June 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="MYDELTAV">
<H2>MYDELTAV</H2></A>
<A HREF="#KLMFLOW">[Previous Routine]</A>
<A HREF="#MYFLOWMODEL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: 
	MYDELTAV

PURPOSE:
	Finds the difference between the observed velocity and that
	predicted by KLMFLOW at a given distance. This will be minimized
	by ZBRAKVEL and ZBRENTVEL in FLOWMODEL.

SYNTAX: 
	result=MYDELTAV(dist, sgl, sgb, vgal)

INPUTS: 
	dist - a given distance
	sgl, sgb, vgal - from calling routine
OUTPUTS: 
	result - difference between observed and predicted velocity.

 REVISION HISTORY:
       Written  KLM January 2003
       Converted to IDL   A.Martin   June 2006

</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="MYFLOWMODEL">
<H2>MYFLOWMODEL</H2></A>
<A HREF="#MYDELTAV">[Previous Routine]</A>
<A HREF="#MYFLOWMODELCALL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
	MYFLOWMODEL
PURPOSE:
	KLM flow model, adapted from the non-linear flow model of Tonry et al (2000),
	which uses Yahil (1985) approximation (good to an overdensity of 30).
 	
	Compute distances from galaxy velocities and co-ordinates. This model includes 
	the spherical infall on the Virgo Attractor and the Great Attractor, as well as 
	a quadrupole correction which could be due either to non-spherical infall or the 
	influence of external masses. There is also a velocity dispersion component which 
	is a combination of thermal velocity dispersion and virial motions in Virgo, the 
	GA and the Fornax Cluster. The parameters of the model were fit to a sample of about 
	300 early-type galaxies with SBF distances (see Tonry et al 2000). 

	The output of this routine consists of up to three possible best solutions. Older versions 
	also output a file from which you can make a plot of the unnormalized 
	probability given the model that the galaxy is at a given distance (which 
	allows an estimate of the error in the model on the distance from the 
	velocity dispersion) and also a file from which you can plot the function
	mydeltav(dist,sgl,sgb,vgal) for the galaxy (to check the roots found are sensible).

	NOTE: This version provides distances independent of h0 (ie. in units of km/s)

SYNTAX:
	MYFLOWMODEL, co1, co2, coopt, vel, velopt, dist, vs, nsolns, flag

INPUTS:
	co1, co2 - the input coordinates. Should be in J2000.
	coopt - a flag which indicates the system of input coordinates co1 & co2.
		coopt = 0: input equatorial, co1=RA, co2=DEC in RADIANS
		coopt = 1: input galactic, co1=l, co2=b in RADIANS
		coopt = 2: input supergalactic, co1=SGL, co2=SGB in RADIANS
		For all flags, coordinates will be transformed to supergalactic SGL
		and SGB in *RADIANS*
	vel - radial velocity of source (km/s)
	velopt - integer, indicating type of input velocity:
		velopt = 0: vcmb will be calculated from vel using Lineweaver conversion.
		velopt = 1: vcmb=vel, ie, input is already converted to CMB

OUTPUTS:
	dist - 3-element array containing distance solutions in km/s
	nsolns - integer; the number of solutions found.
	flag - integer; an output flag to indicate possible problems; see notes.
	
REVISION HISTORY:
	Created 24th Jan 2003, Karen L. Masters (KLM)
	Last update 4th Feb 2003, KLM 

	This version provides distances independent of h0 (ie. in units of km/s).
	May 16th 2003, KLM.
	J2000 co-ords, Feb 2005, KLM
	Uses flow model fit to SFI++. June 2005, KLM
       Converted to IDL   A.Martin   June 2006

NOTES:
       FLAG    (INT)   Flag to indicate possible problems
                       0: No distance found. Usually close to D=0Mpc
                       1: Everything is fine, single valued distance
                      2: Double valued distance
                      3: Triple valued distance
                      10: Assigned to Virgo Core
                      11: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), single valued 
                      12: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), double valued 
                      13: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), triple valued 
                      20: Assigned to GA Core
                      21: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), single valued
                      22: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), double valued
                      23: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), triple valued
                      30: Assigned to Core of Fornax cluster

	Cosmology:
       	Ho             Hubble's constant
       	(wx,wy,wz)     Peculiar velocity of Sun in CMB frame
       	omega          Mass density parameter
       	thermal        Thermal velocity dispersion in universe
       
 	Quadrupole:
       	rquad          Cut-off radius
       	qxx, qxy, qxz, qyz, qzz

 	Attractors:
       	xa,ya,za       Position in Supergalactic cartesian co-ords relative
       	               to Local Group
       	deltaa         Overdensity at position of LG
       	gammaa         Power law fall off
       	rcore         Core radius
       	rcuta          Cut-off radius
       	siga           Virial velocity dispersion which falls off like a 
			       Gaussian centred on the attractor with width rcore
     
		Note: model also has non-attracting overdensities which are
		simply described by a position and virial velocity dispersion

 	Input to model
 
       	sgx,sgy,sgz     Supergalactic cartesian co-ords of galaxy
       	r               Trial distance for galaxy      

 	Output from model

       	vx,vy,vz        Velocity in supergalactic cartesian co-ords in 
                       CMB frame
       	vr              Radial velocity in CMB frame
       	vsig            Velocity dispersion at position of galaxy

</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="MYFLOWMODELCALL">
<H2>MYFLOWMODELCALL</H2></A>
<A HREF="#MYFLOWMODEL">[Previous Routine]</A>
<A HREF="#NWRDS">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME:
	MYFLOWMODELCALL
PURPOSE:
	To call flowmodel routine, deal with plausible errors on 
	distances, and pick out the best distance out of multiple solutions. 

	In this version you can pick your favourite value of H0 at the end as all
	distances are dealt with in km/s units. Just divide the output distance 
	(which is in km/s) by desired H0.

SYNTAX:
	MYFLOWMODELCALL, co1, co2, coopt, vel, velopt, distance, edit, flag

INPUTS:
	co1, co2 - the input coordinates. Should be in J2000.
	coopt - a flag which indicates the system of input coordinates co1 & co2.
		coopt = 0: input equatorial, co1=RA, co2=DEC in RADIANS
		coopt = 1: input galactic, co1=l, co2=b in RADIANS
		coopt = 2: input supergalactic, co1=SGL, co2=SGB in RADIANS
		For all flags, coordinates will be transformed to supergalactic SGL
		and SGB in *RADIANS*
	vel - velocity
	velopt - integer, indicating type of input velocity:
		velopt = 0: Input velocity is heiocentric; vcmb will be calculated using Lineweaver conversion.
		velopt = 1: Input is CMB velocity, i.e. CMB velocity has already been calculated

OUTPUTS:
	distance - distance, selected by the program, reported for input coordinates, in units of km/s
	edist - error, estimated by the program, in km/s
	flag - integer; an output flag to indicate possible problems; see notes.
	
REVISION HISTORY:
       Written  KLM
       Converted to IDL   A.Martin   June 2006

NOTES:
       FLAG    (INT)   Flag to indicate possible problems
                       0: No distance found. Usually close to D=0Mpc
                       1: Everything is fine, single valued distance
                      2: Double valued distance
                      3: Triple valued distance
                      10: Assigned to Virgo Core
                      11: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), single valued 
                      12: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), double valued 
                      13: Near Virgo (within 6Mpc which is region where SB00 
                          claim that model is "uncertain"), triple valued 
                      20: Assigned to GA Core
                      21: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), single valued
                      22: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), double valued
                      23: Near GA (within 10Mpc which is region where SB00 
                          claim that model is "uncertain"), triple valued
                      30: Assigned to Core of Fornax cluster

 
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="NWRDS">
<H2>NWRDS</H2></A>
<A HREF="#MYFLOWMODELCALL">[Previous Routine]</A>
<A HREF="#PLOTCLUSTER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       NWRDS
 PURPOSE:
       Return the number of words in the given text string.
 CATEGORY:
 SYNTAX:
       n = nwrds(txt)
 INPUTS:
       txt = text string to examine.             in
 KEYWORD PARAMETERS:
       Keywords:
         DELIMITER = d.  Set delimiter character (def = space).
 OUTPUTS:
       n = number of words found.                out
 COMMON BLOCKS:
 NOTES:
       Notes: See also getwrd.
 MODIFICATION HISTORY:
       R. Sterner,  7 Feb, 1985.
       Johns Hopkins University Applied Physics Laboratory.
       RES 4 Sep, 1989 --- converted to SUN.

 Copyright (C) 1985, Johns Hopkins University/Applied Physics Laboratory
 This software may be used, copied, or redistributed as long as it is not
 sold and this copyright notice is reproduced on each copy made.  This
 routine is provided as is without any express or implied warranties
 whatsoever.  Other limitations apply as described in the file disclaimer.txt.
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PLOTCLUSTER">
<H2>PLOTCLUSTER</H2></A>
<A HREF="#NWRDS">[Previous Routine]</A>
<A HREF="#PLOTFRAME">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PLOTCLUSTER
 PURPOSE:
       Set up the gui for plotcluster. Plotcluster displays a widget
       where the user can input coordinates and the size of the box
       that the user wants to view. Plotcluster will plot all
       galaxies, clusters and NOG groups (if NOG option is turned on) in
       the user specified region. If a cluster or NOG group is in the
       region a cz vs. R plot is made of all the galaxies inside the
       NOG group or cluster radius. A cz historgram is also made of all the
       galaxies in the cluster or NOG group radius. The user can also
       specify a box of which a cz vs. R plot and a cz historgram are made.

 EXPLANATION:
       Set up the gui and let the event handler do the rest of the
       work (plotting)

 SYNTAX:
       PLOTCLUSTER


 REVISION HISTORY:
       Written by W.H.during summer 2006
  

 PROCEDURES CALLED
       PLOTCLUSTER_EVENT

 NOTES:
       THIS PROGRAM REQUIRES THE AGC CATALOG TO BE LOCATED IN 
       THE AGCDIR. IT ALSO REQUIRES A FILE
       NAMED clustercat WITH THE CLUSTER CATALOG INFORMATION IN IT.
       nog.tab7 IS ANOTHER FILE REQUIRED. THIS FILE HAS ALL THE NOG 
       GROUP INFORMATION. ALL THESE FILES NEED TO BE LOCATED IN THE
       AGCDIR.
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PLOTFRAME">
<H2>PLOTFRAME</H2></A>
<A HREF="#PLOTCLUSTER">[Previous Routine]</A>
<A HREF="#PLOTHISTANDCZR_CLUSTER">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PLOTFRAME
 PURPOSE:
       Does the actual plotting of the clusters, galaxies and frame of
       interest.
 EXPLANATION:
       Takes the user defined range and coordinates and then plots
       all the galaxies and clusters in this range.

 SYNTAX:
       PLOTFRAME, CENTRA, CENTDEC, RAMIN, RAMAX, DECMIN, DECMAX,
       NAGC, XRA, YDEC, GSIZE, GELLIP, GPOSANG, GVEL, NGALS, $
       R_CLUST, NCLUST, XRA_CLUST, YDEC_CLUST, CLUST_VELOCITY, HARD,$
       FILENAME_PLOT, RANGE, CLUST_ID

 INPUTS:
       CENTRA - Center R.A. defined by user
       CENTRDEC - Center Dec defined by user
       RAMIN - Minimum R.A. in range
       RAMAX - Maximum R.A. in range
       DECMIN - Minimum Dec in range
       DECMAX - Maximum Dec in range
       XRA - Array with the R.A.'s of the galaxies found in range
       YDEC - Array with the Decs of the galaxies found in range
       GSIZE - Array of sizes of galaxies to be plotted
       GELLIP - Eccentricity of the galaxy
       GPOSANG - Array of position angles of the found galaxies
       GVEL - Array of velocities of the found galaxies
       NGALS - Number of galaxies found
       R_CLUST - Array of radii of the cluster
       NCLUST - Number of cluster in range
       XRA_CLUST -  Array with the R.A.'s of the clusters found in
                   range
       YDEC_CLUST - Array with the Decs of the clusters found in
                    range
       CLUST_VELOCITY - Array of velocities of the found clusters
       HARD - Whether or not this plot should be on postscript of
              screen, 0 is on screen, 1 is on postscript
       FILENAME_PLOT - Name of postscript file to plot on
       RANGE - Range defined by user
       CLUST_ID - Array of cluster id's 

 PROCEDURES CALLED
       PRINTAGCINFO, DRAWGAL, DRAWCLUST, PRINTCLUSTERINFO

 REVISION HISTORY:
       Written by M.H. in fortran and translated and updated to idl
       with added features by
       W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PLOTHISTANDCZR_CLUSTER">
<H2>PLOTHISTANDCZR_CLUSTER</H2></A>
<A HREF="#PLOTFRAME">[Previous Routine]</A>
<A HREF="#PLOTHISTANDCZR_NOG">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PLOTHISTANDCZR_CLUSTER
 PURPOSE:
       Plot the cz histogram and the cz vs r plot
 EXPLANATION:
       Takes cluster info and plots the velocity of the galaxies
       inside the radius of the cluster vs the cluster-galaxy
       separation. Also makes a histogram of the velocities of the
       galaxies inside the radius of the cluster

 SYNTAX:
        PLOTHISTANDCZR_CLUSTER, XRA_CLUST, XRA, YDEC_CLUST, YDEC,$
        R_CLUST, NGAL, INDEX, GVEL, CLUST_VELOCITY, DRAW_CZ,$
        DRAW_CZ_HIST, POINT_INFO, BIN_SLIDER, INFO, INFOPTR, $
        CZSCALE, JUST_SCALE

 INPUTS:
       XRA_CLUST -  Array with the R.A.'s of the clusters found in
                    range
       XRA - Array with the R.A.'s of the galaxies found in range
       YDEC_CLUST - Array with the Decs of the clusters found in
                    range
       YDEC - Array with the Decs of the galaxies found in range
       R_CLUST - Array of radii of the cluster
       NGALS - Number of galaxies found
       INDEX - Which cluster are we plotting for
       GVEL - Array of velocities of the found galaxies
       CLUST_VELOCITY - Array of velocities of the found clusters
       DRAWCZ - Wigdet id of the cz vs. r plot draw widget
       DRAW_CZ_HIST - Widget id of the cz histogram draw widget
       POINT_INFO - Widget id of the info text box
       BINSLIDER - Widget id of the cz bin slider
       INFO - Structure to be saved for SAVESTATEINFO call
       INFOPTR - Pointer pointing to the destination of the updated
                 structure for SAVESTATEINFO call
       CZSCALE - Zoom scale for the cz vs r plot
       JUSTCALE - Whether or not only the cz vs r plot should be scaled

 PROCEDURES CALLED
       PRINTCLUSTERINFO, PLOTHIST, SAVESTATEINFO, CARTES  


 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PLOTHISTANDCZR_NOG">
<H2>PLOTHISTANDCZR_NOG</H2></A>
<A HREF="#PLOTHISTANDCZR_CLUSTER">[Previous Routine]</A>
<A HREF="#PRINTAGCINFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PLOTHISTANDCZR_NOG
 PURPOSE:
       Plot the cz histogram and the cz vs r plot
 EXPLANATION:
       Takes nog info and plots the velocity of the galaxies
       inside the radius of the nog vs the nog-galaxy
       separation. Also makes a histogram of the velocities of the
       galaxies inside the radius of the nog

 SYNTAX:
        PLOTHISTANDCZR_NOG, XRA_NOG, XRA, YDEC_NOG, YDEC,$
        R_NOG, NGAL, INDEX, GVEL, NOG_VELOCITY, DRAW_CZ,$
        DRAW_CZ_HIST, POINT_INFO, BIN_SLIDER, INFO, INFOPTR, $
        CZSCALE, JUST_SCALE

 INPUTS:
       XRA_NOG -  Array with the R.A.'s of the nogs found in
                    range
       XRA - Array with the R.A.'s of the galaxies found in range
       YDEC_NOG - Array with the Decs of the nogs found in
                    range
       YDEC - Array with the Decs of the galaxies found in range
       R_NOG - Array of radii of the nog
       NGALS - Number of galaxies found
       INDEX - Which nog are we plotting for
       GVEL - Array of velocities of the found galaxies
       NOG_VELOCITY - Array of velocities of the found nogs
       DRAWCZ - Wigdet id of the cz vs. r plot draw widget
       DRAW_CZ_HIST - Widget id of the cz histogram draw widget
       POINT_INFO - Widget id of the info text box
       BINSLIDER - Widget id of the cz bin slider
       INFO - Structure to be saved for SAVESTATEINFO call
       INFOPTR - Pointer pointing to the destination of the updated
                 structure for SAVESTATEINFO call
       CZSCALE - Zoom scale for the cz vs r plot
       JUSTCALE - Wether or not only the cz vs r plot should be scaled

 PROCEDURES CALLED
       PRINTNOGINFO, PLOTHIST, SAVESTATEINFO, CARTES  


 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PRINTAGCINFO">
<H2>PRINTAGCINFO</H2></A>
<A HREF="#PLOTHISTANDCZR_NOG">[Previous Routine]</A>
<A HREF="#PRINTCLUSTERINFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PRINTAGCINFO
 PURPOSE:
       Output a string with agc info if cursor was on a agc galaxy 
 EXPLANATION:
       It reads in the file containing the info on the agc galaxies
       in the specified range and then checks if the cursor is within
       a certain range of the coordinates of the galaxy

 SYNTAX:
       PRINTAGCINFO, XCURS, YCURS, FOUNDFLAG, OUTPUTSTR

 INPUTS:
       XCURS - X position of the cursor 
       YCURS - Y position of the cursor

 OUTPUTS:
       FOUNDFLAG - If there are no agc galaxies in the position
                        this is set to 0 else 1.
       OUTPUTSTR - The string containing the agc info of the agc
                      galaxy

 REVISION HISTORY:
       Written by M.H. in fortran and translated to idl by
       W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PRINTCLUSTERINFO">
<H2>PRINTCLUSTERINFO</H2></A>
<A HREF="#PRINTAGCINFO">[Previous Routine]</A>
<A HREF="#PRINTNOGINFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PRINTCLUSTERINFO
 PURPOSE:
       Output a string with cluster info if cursor was on a cluster 
 EXPLANATION:
       It reads in the file containing the info on the clusters
       in the specified range and then checks if the cursor is within
       a certain range of the coordinates of the cluster

 SYNTAX:
       PRINTCLUSTERINFO, XCURS, YCURS, FOUNDFLAG, OUTPUTSTR

 INPUTS:
       XCURS - X position of the cursor 
       YCURS - Y position of the cursor


 OUTPUTS:
       FOUNDFLAG - If there are no clusters in the position
                        this is set to 0 else 1.
       OUTPUTSTR - The string containing the cluster info of the 
                      cluster

 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="PRINTNOGINFO">
<H2>PRINTNOGINFO</H2></A>
<A HREF="#PRINTCLUSTERINFO">[Previous Routine]</A>
<A HREF="#SAVESTATEINFO">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
       PRINTNOGINFO
 PURPOSE:
       Output a string with nog info if cursor was on a nog 
 EXPLANATION:
       It reads in the file containing the info on the nogs
       in the specified range and then checks if the cursor is within
       a certain range of the coordinates of the nog

 SYNTAX:
       PRINTNOGINFO, XCURS, YCURS, FOUNDFLAG, OUTPUTSTR

 INPUTS:
       XCURS - X position of the cursor 
       YCURS - Y position of the cursor


 OUTPUTS:
       FOUNDFLAG - If there are no nogs in the position
                        this is set to 0 else 1.
       OUTPUTSTR - The string containing the nog info of the 
                      nog

 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="SAVESTATEINFO">
<H2>SAVESTATEINFO</H2></A>
<A HREF="#PRINTNOGINFO">[Previous Routine]</A>
<A HREF="#VHEL_TO_CMB">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
NAME: 
	SAVESTATEINFO

PURPOSE:
	Save all important info into the state structure

SYNTAX: 
	SAVESTATEINFO, INFO, INFOPTR

INPUTS: 
	INFO - Structure to be saved
       INFOPTR - Pointer pointing to the destination of the updated
                 structure
 REVISION HISTORY:
       Written by W.H. during summer 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="VHEL_TO_CMB">
<H2>VHEL_TO_CMB</H2></A>
<A HREF="#SAVESTATEINFO">[Previous Routine]</A>
<A HREF="#ZBRAKVEL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:  
       VHEL_TO_CMB

 PURPOSE:
        Calculate the projection along the LOS velocity wrt to the CMB velocity

 EXPLANATION:
       Function takes lb coordinates to compute the projection along 
       the LOS velocity wrt to the CMB velocity.  Quite simple.

 SYNTAX: 
       result=VHEL_TO_CMB(l,b)

 INPUT PARAMETERS: 
       l:  galactic longitude in degrees
       b:  galactic latitude in degrees

 OUTPUT PARAMETERS: ;
      result - CMB velocity projected along the line of sight.
              
 EXAMPLES:

      IDL> print,  35344+vhel_to_cmb(112.62994,-25.039215)
            You should get:  35031.226

	Comments from original FORTRAN program:

	"Computes the component, in the direction of
	a given galaxy, of the motion of the Sun with
	respect to the Local Universe. Source for velocities
	and directions : Kogut et al. 1993 (ApJ 419,1)
       Also added the Lineweaver 1996 paper.

	Assumes you have already converted RA,Dec to l,b IN DEGREES!
	Be sure to put a declaration statement like
	REAL Vhel_to_CMB(GLONGR,GLATR)
	in your main program. and then something like:
	vcmb = vhelio + VHEL_to_CMB(glr,gbr)."


 HISTORY: 
       FORTRAN subroutine by R. Giovanelli, M.P. Haynes
       Conversion to IDL, B. Kent, Cornell University, 2006
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="ZBRAKVEL">
<H2>ZBRAKVEL</H2></A>
<A HREF="#VHEL_TO_CMB">[Previous Routine]</A>
<A HREF="#ZBRENTVEL">[Next Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ZBRAKVEL

 PURPOSE:
	NOTE: This is NOT the original ZBRAK; it has been altered to allow
	functions which call FOUR arguments (3 in addition to X).

	THIS VERSION OF ZBRAK IS TAILORED TO THE FUNCTION MYDELTAV.

	Bracket a zero that ZBRENT can then identify. Given a function FX
	defined on the interval from x1 to x2, ZBRAK subdivides the interval
	into n equally spaced segments and searches for zero-crossings of the
	function. nb is an input, specifying the number of roots sought, and
	is reset in the end to the number of bracketing pairs (xb1,xb2) that
	are found by the function.

 EXPLANATION:
	This routine "looks inward," starting from an initial interval, to
	identify regions where a function changes sign.
	Adapted from procedure of the same name in "Numerical Recipes" by
	Press et al. (1992), Section 9.1

 SYNTAX:
       ZBRAKVEL, x1, x2, n, nb, xb1, xb2, nfound, sgl, sgb, vgal, FUNC_NAME="name" 

 INPUTS:
       x1, x2 - scalars, 2 points which bracket location of function zero,
                                               that is, F(x1) < 0 < F(x2).
	n - the number of intervals into which the function will divide the
						bracketed region.
	nb - the number of roots sought

	sgl, sgb, vgal - deltav requires these inputs
	

 REQUIRED INPUT KEYWORD:
       FUNC_NAME = function name (string)

 OUTPUTS:
       xb1, xb2 - arrays specifying the bracketing pairs for ZBRENT.
	nfound - the number of solutions found.


 MODIFICATION HISTORY:
       Converted to IDL from Num. Rec.   A. Martin   June 2006
	Modified for specific function mydeltav.
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
<A NAME="ZBRENTVEL">
<H2>ZBRENTVEL</H2></A>
<A HREF="#ZBRAKVEL">[Previous Routine]</A>
<A HREF="#ROUTINELIST">[List of Routines]</A>
<PRE>
 NAME:
	ZBRENTVEL

 PURPOSE:
	NOTE: This is NOT the original ZBRENT; it has been altered to allow
	functions which FOUR arguments (3 in addition to X)

	THIS VERSION IS TAILORED TO THE FUNCTION MYDELTAV

	Find the zero of a 1-D function up to specified tolerance.

 EXPLANATION:
	This routine assumes that the function is known to have a zero.
	Adapted from procedure of the same name in "Numerical Recipes" by
	Press et al. (1992), Section 9.3

 SYNTAX:
	result = ZBRENTVEL( x1, x2, sgl, sgb, vgal, FUNC_NAME="name" )

 INPUTS:
       x1, x2 = scalars, 2 points which bracket location of function zero,
                                               that is, F(x1) < 0 < F(x2).
       Note: computations are performed with
       same precision (single/double) as the inputs and user supplied function.

 REQUIRED INPUT KEYWORD:
       FUNC_NAME = function name (string)
               Calling mechanism should be:  F = func_name( px, sgl, sgb, vgal )

 OPTIONAL INPUT KEYWORD:
       MAX_ITER = maximum allowed number iterations, default=100.
       TOLERANCE = desired accuracy of minimum location, default = 1.e-3.
			NOTE: AM 2006: new version defaults to 1.e-4.

 OUTPUTS:
       Returns the location of zero, with accuracy of specified tolerance.

 PROCEDURE:
       Brent's method to find zero of a function by using bracketing,
       bisection, and inverse quadratic interpolation.

 MODIFICATION HISTORY:
       Written, Frank Varosi NASA/GSFC 1992.
       FV.1994, mod to check for single/double prec. and set zeps accordingly.
       Converted to IDL V5.0   W. Landsman   September 1997
	Altered by A. Martin	June 2006	to change the default tolerance to 1.e-4
						Modified for specific function mydeltav
</PRE><P>
<STRONG>(See plotcluster.pro)</STRONG><P>
<HR>
 
</body>
</html>
